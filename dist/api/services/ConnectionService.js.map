{"version":3,"sources":["api/services/ConnectionService.js"],"names":[],"mappings":";;AACA,IAAI,MAAM,GAAI,OAAO,CAAC,kBAAkB,CAAC,CAAC;;AAE1C,IAAI,YAAY,GAAG,EAAE,CAAC;;AAEtB,MAAM,CAAC,OAAO,GAAG;AAChB,cAAa,EAAE,uBAAS,UAAU,EAAC;AAClC,MAAG,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,EAAC,MAAM,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC;AAC1F,cAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,UAAU,CAAC;AAC7C,QAAM,CAAC,IAAI,CAAC,oBAAoB,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;EACvD;AACD,iBAAgB,EAAE,0BAAS,UAAU,EAAC;AACrC,MAAG,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ;AAAC,UAAO;GAAA,AACvC,OAAO,WAAW,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AAChD,QAAM,CAAC,IAAI,CAAC,oBAAoB,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;EACvD;AACD,mBAAkB,EAAE,4BAAS,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAC;AACnD,MAAI,UAAU,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;AACxC,MAAG,CAAC,UAAU;AAAC,UAAO;GAAA,AACtB,UAAU,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;EACpC;AACD,oBAAmB,EAAE,6BAAS,UAAU,EAAE,MAAM,EAAE,IAAI,EAAC;;;AACtD,SAAO,UAAU,CAAC,GAAG,CAAC,UAAC,QAAQ;UAAG,MAAK,kBAAkB,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC;GAAA,CAAC,CAAC;EACnF;CACD,CAAC","file":"api/services/ConnectionService.js","sourcesContent":["\nvar logger  = require('../../lib/logger');\n\nvar _connections = {};\n\nmodule.exports = {\n\taddConnection: function(connection){\n\t\tif(!connection.session.deviceId)throw new Error(\"Cannot add connection without deviceId\");\n\t\t_connections[connection.userId] = connection;\n\t\tlogger.info(\"+1 connections(%s)\", _connections.length);\n\t},\n\tremoveConnection: function(connection){\n\t\tif(!connection.session.deviceId)return;\n\t\tdelete _connection[connection.session.deviceId];\n\t\tlogger.info(\"-1 connections(%s)\", _connections.length);\n\t},\n\tsendActionToDevice: function(deviceId, action, data){\n\t\tvar connection = _connections[deviceId];\n\t\tif(!connection)return;\n\t\tconnection.sendAction(action, data);\n\t},\n\tsendActionToDevices: function(devicesIds, action, data){\n\t\treturn devicesIds.map((deviceId)=>this.sendActionToDevice(deviceId, action, data));\n\t}\n};"],"sourceRoot":"/source/"}